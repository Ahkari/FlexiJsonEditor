(function(c){function k(b){return"[object Object]"==Object.prototype.toString.call(b)}function l(b){return"[object Array]"==Object.prototype.toString.call(b)}function m(b,a,f){var d=2==arguments.length;if(-1<a.indexOf(".")){for(var e=b,c=0,h=a.split("."),j=h.length;c<j-1;c++)e=e[h[c]];d?delete e[h[j-1]]:e[h[j-1]]=f}else d?delete b[a]:b[a]=f;return b}function n(b){var a;try{a=JSON.parse(b)}catch(f){a=null,window.console&&console.error("JSON parse failed.")}return a}function p(b){var a;try{a=JSON.stringify(b)}catch(f){a=
"null",window.console&&console.error("JSON stringify failed.")}return a}function r(b){if(0==b.children(".expander").length){var a=c("<span>",{"class":"expander"});a.bind("click",function(){c(this).parent().toggleClass("expanded")});b.prepend(a)}}function q(b,a,f,d){d=d||"";f.children(".item").remove();for(var e in a)if(a.hasOwnProperty(e)){var g=c("<div>",{"class":"item","data-path":d}),h=c(b.propertyElement||"<input>",{"class":"property"}),j=c(b.valueElement||"<input>",{"class":"value"});(k(a[e])||
l(a[e]))&&r(g);g.append(h).append(j);f.append(g);h.val(e).attr("title",e);var m=p(a[e]);j.val(m).attr("title",m);s(g,a[e]);h.change(u(b));j.change(v(b));if(k(a[e])||l(a[e]))q(b,a[e],g,(d?d+".":"")+e)}if(k(a)||l(a))e=c("<div>",{"class":"item appender"}),g=c("<button></button>",{"class":"property"}),g.text("Add New Value"),e.append(g),f.append(e),g.click(function(){if(l(a))a.push(null);else if(k(a)){for(var c=1,e="newKey";a.hasOwnProperty(e);)e="newKey"+c,c++;a[e]=null}q(b,a,f,d);b.onchange(n(p(b.original)))})}
function t(b,a){c(b).parentsUntil(a.target).each(function(){var b=c(this).data("path"),b=(b?b+".":b)+c(this).children(".property").val(),d;a:{d=a.original;for(var b=b.split("."),e=0;e<b.length;)if(void 0==(d=d[b[e++]])){d=null;break a}}d=p(d);c(this).children(".value").val(d).attr("title",d)})}function u(b){return function(){var a=c(this).parent().data("path"),f=n(c(this).next().val()),d=c(this).val(),e=c(this).attr("title");c(this).attr("title",d);m(b.original,(a?a+".":"")+e);d&&m(b.original,(a?
a+".":"")+d,f);t(this,b);d||c(this).parent().remove();b.onchange(n(p(b.original)))}}function v(b){return function(){var a=c(this).prev().val(),f=n(c(this).val()||"null"),d=c(this).parent(),e=d.data("path");m(b.original,(e?e+".":"")+a,f);(k(f)||l(f))&&!c.isEmptyObject(f)?(q(b,f,d,(e?e+".":"")+a),r(d)):d.find(".expander, .item").remove();s(d,f);t(this,b);b.onchange(n(p(b.original)))}}function s(b,a){var c="null";k(a)?c="object":l(a)?c="array":"[object Boolean]"==Object.prototype.toString.call(a)?c=
"boolean":"[object String]"==Object.prototype.toString.call(a)?c="string":"[object Number]"==Object.prototype.toString.call(a)&&(c="number");b.removeClass(w);b.addClass(c)}c.fn.jsonEditor=function(b,a){a=a||{};b=n(p(b));var f=a.change||function(){};return this.each(function(){var d={target:c(this),onchange:f,original:b,propertyElement:a.propertyElement,valueElement:a.valueElement};q(d,b,d.target);c(".property, .value",d.target).live("blur focus",function(){c(this).toggleClass("editing")})})};var w=
"object array boolean number string null"})(jQuery);